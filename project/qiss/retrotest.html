<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>QISS - Microsoft Internet Explorer</title>
    <link rel="shortcut icon" type="image/x-icon" href="/logo.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Marlett Font (Windows System Icons) -->
    <link href="https://db.onlinewebfonts.com/c/c8da7be807a6253e53142d51f6d3c37d?family=Marlett" rel="stylesheet">
    
    <!-- [NEW] Galmuri Font (ëª¨ë°”ì¼ êµ´ë¦¼ì²´ ëŒ€ì²´ìš© ì›¹í°íŠ¸) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/galmuri@latest/dist/galmuri.css">
    
    <!-- Google CSE -->
    <script async src="https://cse.google.com/cse.js?cx=b794e851ac2524ee7"></script>
    <!-- Marked.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>

    <style>
        /* ----------------------------------------------------------------
           WINDOWS 98 / IE 4.0 THEME - BASE
           ---------------------------------------------------------------- */
        :root {
            --win-teal: #008080;
            --win-gray: #c0c0c0;
            --win-gray-light: #ffffff;
            --win-gray-dark: #808080;
            --win-black: #000000;
            --win-blue: #000080;
            
            /* Classic Web Colors */
            --link-blue: #0000FF;
            --link-visited: #800080;
            --link-active: #FF0000;
            --url-green: #008000;
        }

        body {
            background-color: var(--win-teal);
            /* [UPDATED] í°íŠ¸ ìˆœì„œ: PC(GulimChe/êµ´ë¦¼ì²´) -> ì—†ìœ¼ë©´ ëª¨ë°”ì¼/ë§¥(Galmuri9) */
            font-family: 'GulimChe', 'êµ´ë¦¼ì²´', 'Galmuri9', 'Gulim', 'êµ´ë¦¼', 'MS Sans Serif', monospace;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* ìƒë‹¨ ì •ë ¬ë¡œ ë³€ê²½í•˜ì—¬ ê½‰ ì±„ì›€ */
            height: 100vh;
            box-sizing: border-box;
            overflow: hidden; /* ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¡¤ ë°©ì§€ (ì°½ ë‚´ë¶€ë§Œ ìŠ¤í¬ë¡¤) */
            
            /* í”½ì…€ í°íŠ¸ íš¨ê³¼ */
            -webkit-font-smoothing: none;
            -moz-osx-font-smoothing: none;
            font-smooth: never;
            text-rendering: geometricPrecision;
        }

        /* ë©”ì¸ ìœˆë„ìš° í”„ë ˆì„ */
        .window {
            /* [UPDATED] í™”ë©´ ê½‰ ì±„ìš°ê¸° ë¡œì§ */
            width: 80%;
            height: calc(100vh - 100px); /* ì‘ì—…í‘œì‹œì¤„ ë†’ì´ë§Œí¼ ëºŒ */
            max-width: none; /* ìµœëŒ€ ë„ˆë¹„ ì œí•œ í•´ì œ */
            margin: 0; /* ë§ˆì§„ ì œê±° */
            
            background: var(--win-gray);
            border: 2px solid;
            border-color: #fff #000 #000 #fff; /* Classic 3D Outset */
            box-shadow: none; /* ì „ì²´í™”ë©´ì´ë¼ ê·¸ë¦¼ì ì œê±° */
            display: flex;
            flex-direction: column;
            position: relative; /* ë‚´ë¶€ ì ˆëŒ€ ìœ„ì¹˜ ìš”ì†Œë¥¼ ìœ„í•´ */
        }

        /* íƒ€ì´í‹€ ë°” */
        .title-bar {
            background: linear-gradient(90deg, var(--win-blue), #1084d0);
            padding: 3px 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0; /* ë†’ì´ ê³ ì • */
        }

        .title-bar-text {
            color: white;
            font-weight: bold;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .title-bar-controls button {
            width: 16px;
            height: 14px;
            background: var(--win-gray);
            border: 1px outset #fff;
            font-size: 9px;
            line-height: 10px;
            padding: 0;
            margin-left: 2px;
            font-weight: bold;
            font-family: sans-serif;
            color: black;
            cursor: default;
        }

        /* ë©”ë‰´ ë°” */
        .menu-bar {
            display: flex;
            border-bottom: 1px solid var(--win-gray-dark);
            padding: 1px 0;
            background: var(--win-gray);
            flex-shrink: 0;
        }

        .menu-item {
            padding: 2px 8px;
            font-size: 12px;
            cursor: default;
        }
        .menu-item:hover {
            background-color: var(--win-blue);
            color: white;
        }
        .menu-item a { text-decoration: none; color: inherit; }

        /* ì£¼ì†Œ í‘œì‹œì¤„ ì˜ì—­ */
        .address-bar-wrapper {
            display: flex;
            align-items: center;
            padding: 4px;
            border-bottom: 1px solid white;
            gap: 5px;
            font-size: 12px;
            flex-shrink: 0;
        }
        
        .address-label { color: #444; }
        
        .address-input {
            flex: 1;
            border: 2px inset #fff;
            padding: 2px 5px;
            font-family: inherit;
            font-size: 12px;
            background: white;
        }

        /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ */
        .viewport {
            background: white;
            border: 2px inset #fff;
            padding: 15px;
            flex: 1; /* ë‚¨ì€ ê³µê°„ ì±„ìš°ê¸° */
            overflow-y: auto;
            position: relative;
        }

        h1.page-title {
            font-size: 28px;
            text-align: center;
            margin: 10px 0 20px 0;
            font-weight: 900;
            letter-spacing: -1px;
            color: black;
            text-shadow: 2px 2px 0px #ddd;
        }

        fieldset {
            border: 2px groove #fff;
            margin-bottom: 20px;
            padding: 10px;
            background: var(--win-gray);
        }

        legend {
            font-size: 12px;
            padding: 0 4px;
            color: black;
        }

        button {
            background: var(--win-gray);
            border: 2px solid;
            border-color: #fff #000 #000 #fff;
            color: black;
            padding: 4px 12px;
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
            margin: 2px;
        }
        
        button:active {
            border-color: #000 #fff #fff #000;
            transform: translate(1px, 1px);
        }

        button:disabled {
            color: var(--win-gray-dark);
            text-shadow: 1px 1px white;
            cursor: wait;
        }

        input[type="text"], input[type="password"] {
            border: 2px inset #fff;
            padding: 4px;
            font-family: inherit;
            background: white;
            font-size: 12px;
        }

        /* ìŠ¤í¬ë¡¤ë°” */
        ::-webkit-scrollbar { width: 16px; background: var(--win-gray); }
        ::-webkit-scrollbar-button { background: var(--win-gray); border: 2px outset #fff; height: 16px; }
        ::-webkit-scrollbar-thumb { background: var(--win-gray); border: 2px outset #fff; }
        ::-webkit-scrollbar-track { background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAIklEQVQIW2NkQAKrVq36zwjjgzjwqkJYUBkCCmACYGFkCgA+2xUE/97u/AAAAABJRU5ErkJggg=='); }

        #mode-toggle { display: block; margin: 0 auto; width: 150px; font-weight: bold; }
        #custom-search { text-align: center; padding: 10px; }
        .search-bar { width: 60%; }

        /* ==========================================================================
           GOOGLE CSE RETRO OVERRIDES 
           ========================================================================== */
        .gsc-control-cse {
            background-color: transparent !important;
            border: none !important;
            padding: 0 !important;
            font-family: inherit !important;
        }
        .gsc-search-box { margin-bottom: 10px !important; }
        .gsc-input-box {
            border: 2px inset #fff !important;
            border-radius: 0 !important;
            background: white !important;
        }
        input.gsc-input {
            padding: 4px !important;
            font-size: 12px !important;
            color: black !important;
        }
        .gsc-search-button-v2 {
            background: var(--win-gray) !important;
            border: 2px outset #fff !important;
            border-radius: 0 !important;
            padding: 6px 12px !important;
            margin-left: 5px !important;
            color: black !important;
            box-shadow: none !important;
            cursor: pointer !important;
        }
        .gsc-search-button-v2 svg { fill: black !important; width: 13px !important; height: 13px !important; }
        .gsc-search-button-v2:active { border-style: inset !important; }
        .gsc-results-wrapper-visible { background: white !important; }
        .gsc-webResult.gsc-result {
            background: white !important;
            border-bottom: 1px dashed #999 !important;
            padding: 15px 0 !important;
            margin: 0 !important;
        }
        .gsc-webResult.gsc-result:hover { background: transparent !important; }
        .gs-title {
            height: auto !important;
            line-height: normal !important;
            text-decoration: none !important;
            margin-bottom: 4px !important;
            display: block !important;
            overflow: visible !important;
        }
        .gs-title a, .gs-title a b, .gs-title a * {
            font-family: inherit !important;
            font-size: 16px !important;
            font-weight: bold !important;
            text-decoration: underline !important;
            display: inline !important;
        }
        .gs-title a:link { color: var(--link-blue) !important; }
        .gs-title a:visited { color: var(--link-visited) !important; }
        .gs-title a:hover { color: var(--link-active) !important; cursor: hand !important; }
        .gs-snippet {
            font-family: inherit !important;
            font-size: 12px !important;
            color: black !important;
            line-height: 1.5 !important;
            margin-top: 5px !important;
        }
        .gsc-url-top, .gs-visibleUrl {
            color: var(--url-green) !important;
            font-size: 11px !important;
            font-family: inherit !important;
            display: block !important;
            margin-top: 2px !important;
        }
        .gsc-thumbnail-inside, .gsc-url-bottom { display: none !important; }
        .gsc-cursor-box {
            margin-top: 20px !important;
            text-align: center !important;
            border-top: 2px groove #fff !important;
            padding-top: 10px !important;
        }
        .gsc-cursor-page {
            display: inline-block !important;
            background: var(--win-gray) !important;
            border: 2px outset #fff !important;
            color: black !important;
            text-decoration: none !important;
            padding: 2px 8px !important;
            margin: 0 2px !important;
            font-size: 12px !important;
            font-family: inherit !important;
        }
        .gsc-cursor-page:hover { color: black !important; background: white !important; }
        .gsc-cursor-current-page {
            background: white !important;
            border: 2px inset #fff !important;
            font-weight: bold !important;
            color: black !important;
        }
        .gsc-adBlock, .gsc-above-wrapper-area { display: none !important; }
        .gcsc-more-maybe-branding-root { display: none !important; }
        
        /* ========================================================================== */

        /* AI ìš”ì•½ */
        #gemini-summary-container { display: none; margin: 15px 0; }
        #gemini-summary { background: white; border: 2px solid black; box-shadow: 4px 4px 0px var(--win-gray); }
        .notepad-header { background: var(--win-blue); color: white; padding: 2px 5px; font-size: 12px; display: flex; justify-content: space-between; }
        #gemini-summary-content { padding: 10px; font-family: inherit; font-size: 13px; line-height: 1.4; }

        /* ëª¨ë‹¬ */
        #api-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.2); z-index: 9999; align-items: center; justify-content: center; }
        #api-modal.show { display: flex; }
        .modal-window { background: var(--win-gray); border: 2px outset #fff; width: 350px; padding: 2px; box-shadow: 4px 4px 10px black; }
        .modal-body { padding: 15px; text-align: center; display: flex; flex-direction: column; align-items: center; gap: 10px; }

        marquee { background: black; color: #00ff00; font-family: monospace; border: 2px inset #fff; font-size: 12px; padding: 2px 0; flex-shrink: 0; }

        .status-bar { background: var(--win-gray); border-top: 1px solid white; padding: 2px; font-size: 11px; display: flex; gap: 5px; flex-shrink: 0; }
        .status-panel { border: 1px inset #fff; padding: 1px 5px; }

        /* [UPDATED] ë²„íŠ¼ ìœ„ì¹˜ ì¡°ì • (IE ì°½ ë‚´ë¶€ ì ˆëŒ€ ìœ„ì¹˜) */
        #api-settings-btn { 
            position: absolute; 
            bottom: 25px; /* ìƒíƒœë°” ìœ„ìª½ */
            right: 5px; 
            z-index: 500; 
            width: 32px; 
            height: 32px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }

        /* Trust Result */
        .trust-result { background: #ffffe0; border: 1px solid black; padding: 5px; font-size: 11px; margin-top: 5px; }
        .trust-score.high { color: blue; font-weight: bold; }
        .trust-score.medium { color: #808000; font-weight: bold; }
        .trust-score.low { color: red; font-weight: bold; text-decoration: blink; }

        /* [NEW] Windows 98 Taskbar Style */
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 28px;
            background: var(--win-gray);
            border-top: 1px solid #fff;
            display: flex;
            align-items: center;
            padding: 2px;
            z-index: 10000;
            box-shadow: 0 -1px 0 #808080 inset; /* ìƒë‹¨ 3D ëŠë‚Œ */
        }

        .start-btn {
            display: flex;
            align-items: center;
            height: 22px;
            margin: 0 2px 0 2px;
            padding: 0 4px;
            font-weight: bold;
            font-style: italic;
            font-size: 13px;
            background: var(--win-gray);
            border: 2px outset #fff;
            box-shadow: 1px 1px 0 black;
        }
        .start-btn img { margin-right: 3px; }
        .start-btn:active {
            border: 2px inset #fff;
            padding: 1px 3px 0 5px; /* ëˆŒë¦° íš¨ê³¼ */
        }

        .taskbar-divider {
            width: 2px;
            height: 20px;
            border-left: 1px solid #808080;
            border-right: 1px solid #fff;
            margin: 0 5px;
        }

        .taskbar-tasks {
            flex: 1;
            display: flex;
            padding-left: 2px;
        }

        /* ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ (ëˆŒë¦° ë²„íŠ¼ íš¨ê³¼) */
        .task-button {
            /* [UPDATED] ë„ˆë¹„ ì¦ê°€ */
            width: 200px;
            height: 22px;
            background: #e0e0e0; /* ì•½ê°„ ì–´ë‘ìš´ íšŒìƒ‰ (ëˆŒë¦° ìƒíƒœ) */
            border: 2px inset #fff;
            display: flex;
            align-items: center;
            padding: 0 5px;
            font-size: 12px;
            font-weight: bold;
            cursor: default;
            /* ë°”ë‘‘íŒ ë¬´ëŠ¬ íŒ¨í„´ íš¨ê³¼ */
            background-image: linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd), 
            linear-gradient(45deg, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%, #ddd);
            background-size: 2px 2px;
            background-position: 0 0, 1px 1px;
        }

        .taskbar-tray {
            /* [UPDATED] ë„ˆë¹„ ì¦ê°€ */
            width: 95px;
            height: 22px;
            border: 2px inset #fff;
            background: var(--win-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 2px;
            font-size: 12px;
            padding-right: 2px;
        }
        
    </style>
</head>
<body>

    <div class="window">
        <!-- ìœˆë„ìš° íƒ€ì´í‹€ë°” -->
        <div class="title-bar">
            <div class="title-bar-text">
                <img src="/logo.ico" onerror="this.src='https://win98icons.alexmeub.com/icons/png/internet_connection_wiz-0.png'" width="16" height="16" style="margin-right:5px">
                QISS - ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ì¸í„°ë„· ìµìŠ¤í”Œë¡œëŸ¬Â® 4.0
            </div>
            <div class="title-bar-controls">
                <button>_</button>
                <button>â–¡</button>
                <button onclick="window.close()">X</button>
            </div>
        </div>

        <!-- ë©”ë‰´ë°” -->
        <div class="menu-bar">
            <div class="menu-item">íŒŒì¼(F)</div>
            <div class="menu-item">í¸ì§‘(E)</div>
            <div class="menu-item">ë³´ê¸°(V)</div>
            <div class="menu-item">ì´ë™(G)</div>
            <div class="menu-item">ì¦ê²¨ì°¾ê¸°(A)</div>
            <div class="menu-item">ë„ì›€ë§(H)</div>
            <div style="flex:1"></div>
            <div class="menu-item"><a href="https://mail.google.com/">ë©”ì¼</a></div>
        </div>

        <!-- ì£¼ì†Œì°½ -->
        <div class="address-bar-wrapper">
            <span class="address-label">ì£¼ì†Œ(D):</span>
            <input type="text" class="address-input" value="http://qpi.kro.kr/" readonly>
        </div>

        <!-- ë§ˆí€´ -->
        <marquee scrolldelay="100">
            *** í•™ìˆ  ë…¼ë¬¸ ëŒ€ì—¬ì  <ì‚¬ë¶„ì£¼ìœ¨ ì—°êµ¬> ê°€ ë§ˆì¹¨ë‚´ ì •ë³´ì˜ ë°”ë‹¤ ì›”ë“œ ì™€ì´ë“œ ì›¹(WWW)ì— ìƒë¥™í–ˆë‹¤! QISS! *** ë³¸ í˜ì´ì§€ëŠ” Microsoft Internet ExplorerÂ® 4.0 í™˜ê²½ì—ì„œ ê°€ì¥ ì¾Œì í•˜ê²Œ ì—´ëŒí•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë„·ìŠ¤ì¼€ì´í”„ ë„¤ë¹„ê²Œì´í„° ì‚¬ìš©ìëŠ” í™”ë©´ì´ ê¹¨ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ì£¼ì˜í•˜ì‹­ì‹œì˜¤. ***
        </marquee>

        <!-- ë·°í¬íŠ¸ (ì‹¤ì œ ë‚´ìš©) -->
        <div class="viewport">
            <h1 class="page-title">QISS <span style="font-size:20px; font-weight:normal; color:#666;">'98</span></h1>
            
            <fieldset>
                <legend>ê²€ìƒ‰ ë°©ì‹</legend>
                <button id="mode-toggle" onclick="toggleMode()">
                    <span class="qiss-text">QISS</span><span class="search-text">&nbsp;ê²€ìƒ‰</span>
                </button>
            </fieldset>

            <div id="custom-search" style="display:none;">
                <fieldset>
                    <legend>ì‚¬ìš©ì ì •ì˜ ê²€ìƒ‰</legend>
                    <input type="text" id="search-bar" class="search-bar" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeydown="handleEnter(event)">
                    <div style="margin-top:10px;">
                        <button onclick="searchInNaver()">ë„¤ì´ë²„ (NAVER)</button>
                        <button onclick="searchInDBpia()">ëˆ„ë¦¬ë¯¸ë””ì–´ DBPia 1.0</button>
                        <button onclick="searchInGs()">ì•¼í›„! ì½”ë¦¬ì•„ í•™ìˆ ê²€ìƒ‰</button>
                        <button onclick="searchInRISS()">í•™ìˆ ì—°êµ¬ì •ë³´ì„œë¹„ìŠ¤</button>
                    </div>
                </fieldset>
            </div>

            <!-- Google CSE -->
            <div id="cse-search" class="gcse-search" data-enableImageSearch="true"></div>

            <!-- Gemini Summary (Notepad Style) -->
            <div id="gemini-summary-container">
                <div id="gemini-summary">
                    <div class="notepad-header">
                        <span>QISS_ë„ìš°ë¯¸.hlp - Windows ë„ì›€ë§</span>
                        <button style="height:16px; width:16px; font-size:8px; padding:0; line-height:8px;" onclick="document.getElementById('gemini-summary-container').style.display='none'">X</button>
                    </div>
                    <div style="padding:2px; background:#e0e0e0; border-bottom:1px solid gray; font-size:11px;">
                        íŒŒì¼(F) í¸ì§‘(E) ê²€ìƒ‰(S) ë„ì›€ë§(H)
                    </div>
                    <div id="gemini-summary-content">
                        <div id="gemini-summary-text"></div>
                        <br>
                        <hr style="border-style: dashed; border-color: #999;">
                        <p style="font-size: 11px; color: #666;">
                            [ì‹œìŠ¤í…œ] ì§€ëŠ¥í˜• ë„ìš°ë¯¸ëŠ” ì˜ëª»ëœ ì •ë³´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì£¼ì˜í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”.
                        </p>
                    </div>
                    <div style="padding:10px; text-align:right; background:white;">
                        <button id="btn-generate-summary" onclick="triggerSummary()">ìš”ì•½ ì‹¤í–‰ (Enter)</button>
                    </div>
                </div>
            </div>

            <br><br>
            <center>
            <div style="font-size:11px; color:#444; margin-top:10px;">
        ì´ í˜ì´ì§€ëŠ” <span style="color:navy; font-weight:bold;">Internet Explorer 4.0</span>ì—ì„œ ê°€ì¥ ì˜ ë³´ì…ë‹ˆë‹¤.<br>
        í•´ìƒë„ 800x600 High Color / ê¸€ê¼´: êµ´ë¦¼ (9pt)<br>
        Copyright â“’ 1998 ì¿¼í„°íŒŒì´ ì „ì‚°. All rights reserved.
    </div>
            </center>
        </div>

        <!-- ìƒíƒœë°” -->
        <div class="status-bar">
            <div class="status-panel" style="width:150px;">ì™„ë£Œ</div>
            <div class="status-panel" style="flex:1;" id="api-status-indicator">ì—°ê²°ë˜ì§€ ì•ŠìŒ</div>
            <div class="status-panel" style="width:20px;"></div>
        </div>

        <!-- [UPDATED] ì„¤ì • ë²„íŠ¼ (ì°½ ë‚´ë¶€ë¡œ ì´ë™) -->
        <button id="api-settings-btn" onclick="openApiModal()" title="ì„¤ì •">
            <img src="https://win98icons.alexmeub.com/icons/png/settings_gear-0.png" width="16" height="16">
        </button>
    </div>

    <!-- [NEW] ì‘ì—…í‘œì‹œì¤„ (Taskbar) -->
    <div class="taskbar">
        <button class="start-btn">
            <img src="https://win98icons.alexmeub.com/icons/png/windows-0.png" width="16" height="16" alt="Win">
            ì‹œì‘
        </button>
        <div class="taskbar-divider"></div>
        <div class="taskbar-tasks">
            <div class="task-button">
                <img src="/logo.ico" onerror="this.src='https://win98icons.alexmeub.com/icons/png/internet_connection_wiz-0.png'" width="16" height="16" style="margin-right:4px;"> 
                Internet Explorer 4.0...
            </div>
        </div>
        <div class="taskbar-tray">
            <img src="https://win98icons.alexmeub.com/icons/png/loudspeaker_rays-0.png" width="16" height="16" style="margin-right:5px;">
            <span id="current-time"></span>
        </div>
    </div>

    <!-- API ì„¤ì • ëª¨ë‹¬ -->
    <div id="api-modal">
        <div class="modal-window">
            <div class="title-bar" style="background: navy;">
                <div class="title-bar-text">ê²½ê³ </div>
                <button onclick="closeApiModal()" style="height:14px; width:14px; padding:0; line-height:10px;">X</button>
            </div>
            <div class="modal-body">
                <div style="display:flex; align-items:center; gap:15px; width:100%;">
                    <img src="https://win98icons.alexmeub.com/icons/png/msg_warning-0.png" width="32" height="32">
                    <div style="text-align:left; font-size:12px;">
                        QISS ì§€ëŠ¥í˜• ê²€ìƒ‰ ë„ìš°ë¯¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´<br>
                        groq ë“±ë¡ ì •ë³´ í‚¤ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                    </div>
                </div>
                <fieldset style="width:90%; padding:5px; margin:5px 0;">
                    <legend>ë“±ë¡ ì •ë³´ í‚¤ ì…ë ¥</legend>
                    <input type="password" id="api-key-input" style="width:95%;">
                </fieldset>
                <div style="display:flex; gap:10px; justify-content:center; width:100%;">
                    <button onclick="saveApiKey()" style="width:70px;">ì˜ˆ (Y)</button>
                    <button onclick="closeApiModal()" style="width:100px;">ì•„ë‹ˆì˜¤ (N)</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        const GROQ_MODEL = 'meta-llama/llama-4-maverick-17b-128e-instruct'; 
        let isCSE = true;
        let currentSearchQuery = '';
        let lastProcessedQuery = '';
        let currentSummaryData = null;

        // Marked.js ì˜µì…˜
        marked.setOptions({ breaks: true, gfm: true });

        // ==========================================
        // UI FUNCTIONS
        // ==========================================
        function toggleMode() {
            isCSE = !isCSE;
            const cse = document.getElementById('cse-search');
            const custom = document.getElementById('custom-search');
            const toggleBtn = document.getElementById('mode-toggle');
            
            document.getElementById('gemini-summary-container').style.display = 'none';

            if (isCSE) {
                toggleBtn.querySelector('.search-text').innerText = " ëª¨ë“œ: ê²€ìƒ‰";
                custom.style.display = 'none';
                cse.style.display = 'block';
            } else {
                toggleBtn.querySelector('.search-text').innerText = " ëª¨ë“œ: ì‚¬ìš©ì";
                cse.style.display = 'none';
                custom.style.display = 'block';
            }
        }

        // [UPDATED] ì‹œê°„ ì—…ë°ì´íŠ¸ (ì‘ì—… í‘œì‹œì¤„ íŠ¸ë ˆì´)
        function updateTime() {
            const now = new Date();
            let hours = now.getHours();
            const minutes = now.getMinutes();
            const ampm = hours >= 12 ? 'ì˜¤í›„' : 'ì˜¤ì „';
            
            hours = hours % 12;
            hours = hours ? hours : 12; // 0ì‹œëŠ” 12ì‹œë¡œ í‘œì‹œ
            
            const strTime = ampm + ' ' + hours + ':' + (minutes < 10 ? '0' + minutes : minutes);
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.innerText = strTime;
            }
        }
        setInterval(updateTime, 1000);
        updateTime(); // ì´ˆê¸° ì‹¤í–‰

        // ê²€ìƒ‰ ì—”í„° ì²˜ë¦¬
        function handleEnter(event) { if (event.key === 'Enter') searchInGoogle(); }
        function getQuery() { return document.getElementById('search-bar').value.trim(); }
        
        // ê²€ìƒ‰ í•¨ìˆ˜ë“¤
        function searchInGoogle() { const q = getQuery(); if (q) window.open('https://www.google.com/search?q=' + encodeURIComponent(q), '_blank'); }
        function searchInNaver() { const q = getQuery(); if (q) window.open('https://search.naver.com/search.naver?where=nexearch&sm=tab_hty&query=' + encodeURIComponent(q), '_blank'); }
        function searchInDBpia() { const q = getQuery(); if (q) window.open('https://www.dbpia.co.kr/search/topSearch?searchOption=all&query=' + encodeURIComponent(q), '_blank'); }
        function searchInGs() { const q = getQuery(); if (q) window.open('https://scholar.google.com/scholar?hl=ko&as_sdt=0%2C5&q=' + encodeURIComponent(q), '_blank'); }
        function searchInRISS() { const q = getQuery(); if (q) window.open('https://www.riss.kr/search/Search.do?colName=all&isDetailSearch=N&searchGubun=true&query=' + encodeURIComponent(q), '_blank'); }

        // ==========================================
        // API & AI FUNCTIONS
        // ==========================================
        function updateApiStatus() {
            const apiKey = localStorage.getItem('GROQ_API_KEY');
            const indicator = document.getElementById('api-status-indicator');
            if (apiKey) {
                indicator.innerHTML = 'ë“±ë¡ ì •ë³´ ì—°ê²°ë¨';
                indicator.style.color = 'navy';
            } else {
                indicator.innerHTML = 'í‚¤ í•„ìš”í•¨';
                indicator.style.color = 'red';
            }
        }

        function openApiModal() {
            const modal = document.getElementById('api-modal');
            const input = document.getElementById('api-key-input');
            const savedKey = localStorage.getItem('GROQ_API_KEY');
            if (savedKey) input.value = savedKey;
            modal.classList.add('show');
            updateApiStatus();
        }

        function closeApiModal() {
            document.getElementById('api-modal').classList.remove('show');
        }

        function saveApiKey() {
            const input = document.getElementById('api-key-input');
            const apiKey = input.value.trim();
            if (apiKey) {
                localStorage.setItem('GROQ_API_KEY', apiKey);
                alert('ì‹œìŠ¤í…œ: ì„¤ì •ì„ ì €ì¥í–ˆìŠµë‹ˆë‹¤.');
                closeApiModal();
                updateApiStatus();
            } else {
                alert('ì˜¤ë¥˜: í‚¤ë¥¼ ì…ë ¥í•˜ì‹­ì‹œì˜¤.');
            }
        }

        window.addEventListener('DOMContentLoaded', updateApiStatus);

        function triggerSummary() {
            if (!currentSummaryData) return;
            const btn = document.getElementById('btn-generate-summary');
            const contentDiv = document.getElementById('gemini-summary-content');
            
            btn.disabled = true;
            btn.innerHTML = 'ì²˜ë¦¬ ì¤‘...';
            contentDiv.style.display = 'block';
            
            generateSummary(currentSummaryData.query, currentSummaryData.results);
        }

        async function generateSummary(query, searchResults) {
            const GROQ_API_KEY = localStorage.getItem('GROQ_API_KEY');
            const summaryText = document.getElementById('gemini-summary-text');
            const btn = document.getElementById('btn-generate-summary');

            if (!GROQ_API_KEY) {
                summaryText.innerHTML = '<span style="color:red">ì˜¤ë¥˜: ë“±ë¡ ì •ë³´ í‚¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</span>';
                btn.innerHTML = 'ì„¤ì • í•„ìš”';
                btn.disabled = false;
                return;
            }

            summaryText.innerHTML = 'ì •ë³´ ë¶„ì„ ì¤‘...';
            
            try {
                let resultsContext = 'ê²€ìƒ‰ì–´: ' + query + '\n\nê²€ìƒ‰ ê²°ê³¼:\n\n';
                searchResults.forEach((result, index) => {
                    resultsContext += `${index + 1}. ${result.title}\n${result.snippet}\n\n`;
                });
                
                const systemPrompt = `ë‹¹ì‹ ì€ ê²€ìƒ‰ ê²°ê³¼ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìì—ê²Œ ê³¼í•™ì ì´ê³  ê°„ê²°í•œ ìš”ì•½ì„ ì œê³µí•˜ëŠ” AIì…ë‹ˆë‹¤. ë‹¤ìŒì€ "${query}"ì— ëŒ€í•œ í•™ìˆ  ê²€ìƒ‰ ê²°ê³¼ì…ë‹ˆë‹¤. ì´ ê²€ìƒ‰ ê²°ê³¼ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì•Œê³  ì‹¶ì–´í•˜ëŠ” ì •ë³´ë¥¼ ê³¼í•™ì ì´ê³  ê°„ê²°í•˜ê²Œ ìš”ì•½í•´ì£¼ì„¸ìš”. í•œêµ­ì–´ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ì„ ììœ ë¡­ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
                
                const userPrompt = `ë‹¤ìŒ ê²€ìƒ‰ ê²°ê³¼ë“¤ì„ ì¢…í•©í•˜ì—¬ ìš”ì•½í•´ì£¼ì„¸ìš”:\n\n${resultsContext}\n\nìš”ì•½ ì‹œ ë‹¤ìŒ ì‚¬í•­ì„ ì§€ì¼œì£¼ì„¸ìš”:\n1. í•µì‹¬ ì •ë³´ë¥¼ ëª…í™•í•˜ê²Œ ì •ë¦¬ (ë§ˆí¬ë‹¤ìš´ ì‚¬ìš© ê°€ëŠ¥)\n2. ê²€ìƒ‰ ê²°ê³¼ì˜ ì£¼ìš” ë‚´ìš©ì„ ì¢…í•©ì ìœ¼ë¡œ ì„¤ëª…. ë§ˆì§€ë§‰ì— ê²°ë¡ ì„ ë‚¼ê²ƒ.\n3. ê°ê´€ì ì´ê³  ì¤‘ë¦½ì , ê³¼í•™ì ì´ê³  ì „ë¬¸ì ì¸ í†¤ ìœ ì§€\n4. ë¶ˆí•„ìš”í•œ ì¸ì‚¬ë§ì´ë‚˜ ì„œë¡  ì—†ì´ ë°”ë¡œ ë³¸ë¡ ìœ¼ë¡œ ì‹œì‘\n5. ê°€ë…ì„±ì„ ìœ„í•´ ì ì ˆíˆ ë§ˆí¬ë‹¤ìš´ ë¬¸ë²• í™œìš© (ì œëª©, ê°•ì¡°, ë¦¬ìŠ¤íŠ¸ ë“±)`;

                const response = await fetch(`https://api.groq.com/openai/v1/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                    },
                    body: JSON.stringify({
                        model: GROQ_MODEL, 
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: userPrompt }
                        ],
                        temperature: 0.7,
                        max_tokens: 1024,
                    })
                });

                if (!response.ok) throw new Error('ë“±ë¡ ì •ë³´ ì‘ë‹µ ì‹¤íŒ¨');
                const data = await response.json();
                
                if (data.choices && data.choices[0]) {
                    const summary = data.choices[0].message.content;
                    summaryText.innerHTML = marked.parse(summary);
                    btn.innerHTML = 'ë‹¤ì‹œ ìš”ì•½';
                    btn.disabled = false;
                }
            } catch (error) {
                summaryText.innerHTML = `<span style="color:red">ì˜¤ë¥˜ ë°œìƒ: ${error.message}</span>`;
                btn.innerHTML = 'ì¬ì‹œë„';
                btn.disabled = false;
            }
        }

        // ==========================================
        // OBSERVERS (SEARCH & DOM)
        // ==========================================
        function monitorSearchResults() {
            const resultsObserver = new MutationObserver(() => {
                if (!isCSE) return;
                
                const results = document.querySelectorAll('.gsc-webResult.gsc-result');
                const searchInput = document.querySelector('input.gsc-input');
                const query = searchInput ? searchInput.value.trim() : '';

                if (results.length > 0 && query && query !== lastProcessedQuery) {
                    const searchResults = [];
                    results.forEach(result => {
                        const titleElement = result.querySelector('.gs-title');
                        const snippetElement = result.querySelector('.gs-snippet');
                        if (titleElement && snippetElement) {
                            searchResults.push({
                                title: titleElement.textContent.trim(),
                                snippet: snippetElement.textContent.trim()
                            });
                        }
                    });

                    const summaryContainer = document.getElementById('gemini-summary-container');
                    if (searchResults.length > 0) {
                        lastProcessedQuery = query;
                        summaryContainer.style.display = 'block';
                        
                        // Insert above results
                        const wrapper = results[0].closest('.gsc-results-wrapper-visible') || results[0].parentElement.parentElement;
                        if(wrapper) wrapper.insertBefore(summaryContainer, wrapper.firstChild);

                        currentSummaryData = { query: query, results: searchResults.slice(0, 5) };
                        document.getElementById('gemini-summary-content').style.display = 'none'; // Initially hidden
                        document.getElementById('btn-generate-summary').innerHTML = 'ë¶„ì„ ì‹¤í–‰';
                        document.getElementById('btn-generate-summary').disabled = false;
                    }
                }
                addTrustButtons();
            });

            resultsObserver.observe(document.body, { childList: true, subtree: true });
        }
        monitorSearchResults();

        // Trust Analysis Buttons
        function addTrustButtons() {
            if (!isCSE) return;
            const results = document.querySelectorAll('.gsc-webResult.gsc-result');
            results.forEach(result => {
                if (result.querySelector('.trust-button')) return;
                
                const titleLink = result.querySelector('.gs-title a');
                if (!titleLink || !titleLink.href) return;

                const btn = document.createElement('button');
                btn.className = 'trust-button';
                btn.innerHTML = 'ğŸ›¡ ë³´ì•ˆ ê²€ì‚¬';
                btn.style.float = 'right';
                btn.onclick = (e) => {
                    e.stopPropagation();
                    analyzeTrust(titleLink.href, btn, result);
                };
                
                const snippet = result.querySelector('.gs-snippet');
                if(snippet) snippet.parentNode.insertBefore(btn, snippet);
            });
        }

        async function analyzeTrust(url, btn, resultContainer) {
            const GROQ_API_KEY = localStorage.getItem('GROQ_API_KEY');
            if (!GROQ_API_KEY) { openApiModal(); return; }

            const originalText = btn.innerHTML;
            btn.innerHTML = 'ë¶„ì„ ì¤‘...';
            btn.disabled = true;

            const existingResult = resultContainer.querySelector('.trust-result');
            if (existingResult) existingResult.remove();

            try {
                const hostname = new URL(url).hostname;
                const systemPrompt = `ë‹¹ì‹ ì€ ì‚¬ì´ë²„ ë³´ì•ˆ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì•ˆì „ì„ ìœ„í•´ ë„ë©”ì¸ì„ í‰ê°€í•©ë‹ˆë‹¤.`;
                const userPrompt = `ëŒ€ìƒ ë„ë©”ì¸: ${hostname}\n\nì´ ì‚¬ì´íŠ¸ì˜ ë³´ì•ˆ ì‹ ë¢°ë„ë¥¼ í‰ê°€í•˜ì—¬ 'ë§¤ìš° ì•ˆì „', 'ì•ˆì „', 'ì–‘í˜¸', 'ì£¼ì˜ í•„ìš”', 'ìœ„í—˜' ì¤‘ í•˜ë‚˜ì˜ ë‹¨ì–´ë§Œ ì¶œë ¥í•˜ì„¸ìš”. ë‹¤ë¥¸ ë§ì€ í•˜ì§€ ë§ˆì„¸ìš”.`;

                const response = await fetch(`https://api.groq.com/openai/v1/chat/completions`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${GROQ_API_KEY}` },
                    body: JSON.stringify({
                        model: GROQ_MODEL,
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: userPrompt }
                        ],
                        temperature: 0.1,
                        max_tokens: 10
                    })
                });

                if (!response.ok) throw new Error('API Error');
                const data = await response.json();
                const grade = data.choices[0].message.content.trim().replace(/['"]/g, '');
                
                const resultDiv = document.createElement('div');
                resultDiv.className = 'trust-result';
                
                let colorClass = 'high';
                if (grade.includes('ì£¼ì˜')) colorClass = 'medium';
                if (grade.includes('ìœ„í—˜')) colorClass = 'low';

                resultDiv.innerHTML = `ë¶„ì„ ê²°ê³¼: <span class="trust-score ${colorClass}">${grade}</span> (ë„ë©”ì¸: ${hostname})`;
                resultContainer.appendChild(resultDiv);
                
                btn.innerHTML = 'ì™„ë£Œ';
                btn.disabled = false;
            } catch (error) {
                btn.innerHTML = 'ì˜¤ë¥˜';
                setTimeout(() => { btn.innerHTML = originalText; btn.disabled = false; }, 2000);
            }
        }
    </script>
</body>
    </html>
